<?xml version="1.0" encoding="UTF-8"?>
<wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
    <wsp:All wsp:Usage="Required">
        <L7p:CustomizeErrorResponse>
            <L7p:Content stringValueReference="inline"><![CDATA[{
   "error":"Authentication Error"
}]]></L7p:Content>
            <L7p:ContentType stringValue="application/json; charset=UTF-8"/>
            <L7p:ExtraHeaders nameValuePairArray="included"/>
            <L7p:HttpStatus stringValue="401"/>
        </L7p:CustomizeErrorResponse>
        <L7p:Include>
            <L7p:PolicyGuid stringValue="0c8321c3-d484-4675-b1be-eddf6e780b8a"/>
        </L7p:Include>
        <L7p:CustomizeErrorResponse>
            <L7p:Content stringValueReference="inline"><![CDATA[{
   "error":"Back-End Error"
}]]></L7p:Content>
            <L7p:ContentType stringValue="application/json; charset=UTF-8"/>
            <L7p:ExtraHeaders nameValuePairArray="included"/>
        </L7p:CustomizeErrorResponse>
        <L7p:Encapsulated>
            <L7p:EncapsulatedAssertionConfigGuid stringValue="14bb7541-8b93-4a6a-b294-bc8981f25cdd"/>
            <L7p:EncapsulatedAssertionConfigName stringValue="demo_returnRequestParameterAsJSON"/>
        </L7p:Encapsulated>
        <L7p:HttpRoutingAssertion>
            <L7p:KeyAlias stringValue="ssl"/>
            <L7p:NonDefaultKeystoreId goidValue="00000000000000000000000000000002"/>
            <L7p:ProtectedServiceUrl stringValue="https://${gateway.demo.backend.host}${gateway.demo.transformerPath}"/>
            <L7p:ProxyPassword stringValueNull="null"/>
            <L7p:ProxyUsername stringValueNull="null"/>
            <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                <L7p:ForwardAll booleanValue="true"/>
                <L7p:Rules httpPassthroughRules="included">
                    <L7p:item httpPassthroughRule="included">
                        <L7p:Name stringValue="Cookie"/>
                    </L7p:item>
                    <L7p:item httpPassthroughRule="included">
                        <L7p:Name stringValue="SOAPAction"/>
                    </L7p:item>
                </L7p:Rules>
            </L7p:RequestHeaderRules>
            <L7p:RequestParamRules httpPassthroughRuleSet="included">
                <L7p:ForwardAll booleanValue="true"/>
                <L7p:Rules httpPassthroughRules="included"/>
            </L7p:RequestParamRules>
            <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                <L7p:ForwardAll booleanValue="true"/>
                <L7p:Rules httpPassthroughRules="included">
                    <L7p:item httpPassthroughRule="included">
                        <L7p:Name stringValue="Set-Cookie"/>
                    </L7p:item>
                </L7p:Rules>
            </L7p:ResponseHeaderRules>
            <L7p:ResponseMsgDest stringValue="backendResponse"/>
            <L7p:SamlAssertionVersion intValue="2"/>
            <L7p:UsesDefaultKeyStore booleanValue="false"/>
        </L7p:HttpRoutingAssertion>
        <L7p:SetVariable>
            <L7p:Base64Expression stringValue="JHtnYXRld2F5LmRlbW8uc2V0dGluZ30="/>
            <L7p:VariableToSet stringValue="demoSetting"/>
        </L7p:SetVariable>
        <L7p:HardcodedResponse>
            <L7p:Base64ResponseBody stringValue="ewogICJyZXF1ZXN0UGFyYW1ldGVycyI6ICR7Y3JhZnRlZF9yZXNwb25zZX0sCiAgImN3cFNldHRpbmdTdGF0dXMiOiIke2RlbW9TZXR0aW5nfSIsCiAgJHtiYWNrZW5kUmVzcG9uc2UubWFpbnBhcnR9Cn0="/>
            <L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/>
        </L7p:HardcodedResponse>
    </wsp:All>
</wsp:Policy>
